Here is the detailed documentation for the code, including function descriptions and the steps to compile and run the program.

---

# File Details Program Documentation

## Purpose
This program reads details of a given file, including its name, extension, path, content, and metadata such as file permissions, size, and timestamps. It outputs this information in a JSON format.

The program supports both text and binary files, with text files displayed as plain content and binary files displayed in Base64 encoding.

## Program Features
1. **Extracts file details**:
    - File name (without extension)
    - File extension
    - Absolute file path
    - File content (either raw binary or text)
    - File metadata (permissions, size, inode, timestamps, etc.)
  
2. **Outputs details in JSON format** for easier processing or viewing.

3. **Base64 encoding** for non-text files (e.g., binary files) to represent their content.

---

## Code Structure and Functions

### `FileDetails` Structure
This structure is used to store file-related information:
```c
typedef struct {
    char name[256];                  // Name of the file (without extension)
    char extension[16];              // Extension of the file
    char path[512];                  // Absolute path of the file
    unsigned char content[MAX_CONTENT_SIZE]; // File content (text or binary)
    size_t content_size;             // Size of the content
    struct stat stat;                // File metadata (permissions, size, timestamps, etc.)
} FileDetails;
```

### Function Descriptions

1. **`get_extension`**
   - **Purpose**: Extracts the file extension from the given filename.
   - **Parameters**: 
     - `filename`: The name of the file.
     - `extension`: The extension is stored in this variable.
   - **Return**: None.
   
   ```c
   void get_extension(const char *filename, char *extension);
   ```

2. **`remove_extension`**
   - **Purpose**: Removes the extension from the filename.
   - **Parameters**:
     - `filename`: The filename from which the extension will be removed.
   - **Return**: None.
   
   ```c
   void remove_extension(char *filename);
   ```

3. **`f`**
   - **Purpose**: Opens a file, reads its details (name, extension, content, metadata), and populates the `FileDetails` structure.
   - **Parameters**:
     - `filepath`: The path of the file to read.
     - `file_details`: A pointer to a `FileDetails` structure where the details will be stored.
   - **Return**: `0` on success, `-1` on failure.
   
   ```c
   int f(const char *filepath, FileDetails *file_details);
   ```

4. **`base64_encode`**
   - **Purpose**: Encodes binary content into a Base64 string. Used for binary files to convert content into a readable format.
   - **Parameters**:
     - `data`: The binary data to be encoded.
     - `length`: The length of the binary data.
   - **Return**: A pointer to a string containing the Base64-encoded content.
   
   ```c
   char* base64_encode(const unsigned char *data, size_t length);
   ```

5. **`print_file_details_json`**
   - **Purpose**: Prints the file details stored in a `FileDetails` structure as a JSON string.
   - **Parameters**:
     - `file_details`: A pointer to the `FileDetails` structure containing the file details.
   - **Return**: None.
   
   ```c
   void print_file_details_json(const FileDetails *file_details);
   ```

6. **`main`**
   - **Purpose**: The main entry point of the program. It accepts a file path as a command-line argument, reads the file details, and prints them in JSON format.
   - **Parameters**: 
     - `argc`: Argument count.
     - `argv`: Argument vector (command-line arguments).
   - **Return**: `EXIT_SUCCESS` on success, `EXIT_FAILURE` on failure.
   
   ```c
   int main(int argc, char *argv[]);
   ```

---

## Key Constants

- `MAX_CONTENT_SIZE`: This constant defines the maximum size of the file content buffer. It is set to 1024 bytes by default, but you can adjust it based on your needs.

```c
#define MAX_CONTENT_SIZE 1024
```

---

## Compilation and Usage

### Step 1: Save the Code
Save the C code in a file called `file_details.c`.

### Step 2: Compile the Code
Use the `gcc` compiler to compile the C program:
```bash
gcc -o file_details file_details.c
```

This will generate an executable called `file_details`.

### Step 3: Run the Program
To run the program, provide the file path as a command-line argument:
```bash
./file_details <file_path>
```
Example:
```bash
./file_details test_code/1.c
```

### Example Output:
If you run the program with the file `test_code/1.c`, the output will look like:
```json
{
  "name": "1",
  "extension": "c",
  "path": "/test_code/1.c",
  "stat": {
    "st_mode": 644,
    "st_size": 1234,
    "st_ino": 3701616,
    "st_uid": 1000,
    "st_gid": 1000,
    "st_atime": 1737093280,
    "st_mtime": 1737093034,
    "st_ctime": 1737093034
  }
}
```

---

## Explanation of Output Fields

- `name`: The name of the file, without its extension.
- `extension`: The file extension (e.g., "txt", "md", "c").
- `path`: The absolute path of the file, starting with a `/`.
- `stat`: A JSON object containing various file metadata:
  - `st_mode`: File permissions (octal).
  - `st_size`: The size of the file in bytes.
  - `st_ino`: Inode number.
  - `st_uid`: User ID of the file owner.
  - `st_gid`: Group ID of the file owner.
  - `st_atime`: Last access time (in seconds since the epoch).
  - `st_mtime`: Last modification time (in seconds since the epoch).
  - `st_ctime`: Change time (in seconds since the epoch).

---

## Notes
1. **Text Files**: The program reads the content of text files (e.g., `.txt`, `.md`) as plain text and prints it in the JSON output.

2. **Binary Files**: The program reads the content of binary files (e.g., `.jpg`, `.png`, `.bin`) in raw form and Base64-encodes it for display in the JSON output.

3. **Path Handling**: The program ensures that the `path` field is always absolute by using the `realpath()` function.

---

## Conclusion
This program allows you to easily retrieve and display file details in a structured JSON format. It is particularly useful for debugging or logging purposes, where file metadata and content need to be processed in a readable format. 

